<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Offshoot | AI Image Variation Engine</title>
    <meta name="description"
        content="Create brand-consistent image variations using custom-trained AI models. Upload samples, train your style, generate offshoots.">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="index.css">
</head>

<body>
    <div class="app-container">
        <!-- Animated Background -->
        <div class="bg-gradient"></div>
        <div class="bg-grid"></div>

        <!-- Header -->
        <header class="header">
            <div class="logo">
                <div class="logo-icon">
                    <svg viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <circle cx="20" cy="20" r="18" stroke="url(#logoGrad)" stroke-width="2" />
                        <path d="M20 8 L20 20 M20 20 L28 28 M20 20 L12 28 M20 20 L26 14" stroke="url(#logoGrad)"
                            stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" />
                        <defs>
                            <linearGradient id="logoGrad" x1="0%" y1="0%" x2="100%" y2="100%">
                                <stop offset="0%" stop-color="#818cf8" />
                                <stop offset="100%" stop-color="#c084fc" />
                            </linearGradient>
                        </defs>
                    </svg>
                </div>
                <span class="logo-text">Offshoot</span>
            </div>
            <nav class="nav-tabs">
                <button class="nav-tab active" data-tab="upload">
                    <span class="tab-icon">üìÅ</span>
                    <span class="tab-text">Upload</span>
                </button>
                <button class="nav-tab" data-tab="train">
                    <span class="tab-icon">üß†</span>
                    <span class="tab-text">Train Model</span>
                </button>
                <button class="nav-tab" data-tab="generate">
                    <span class="tab-icon">‚ú®</span>
                    <span class="tab-text">Generate</span>
                </button>
            </nav>
            <div class="header-actions">
                <div class="model-badge" id="modelBadge">
                    <span class="badge-dot"></span>
                    <span>No Models</span>
                </div>
                <button class="btn-icon" id="settingsBtn" title="Settings">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="3" />
                        <path
                            d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42" />
                    </svg>
                </button>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Upload Tab -->
            <section class="tab-content active" id="uploadTab">
                <div class="section-header">
                    <h1>Train Your Style Model</h1>
                    <p>Upload 5-20 sample images to teach AI your visual language</p>
                </div>

                <div class="upload-container">
                    <div class="upload-zone" id="uploadZone">
                        <div class="upload-icon">
                            <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="1.5">
                                <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4M17 8l-5-5-5 5M12 3v12" />
                            </svg>
                        </div>
                        <h3>Drop style samples here</h3>
                        <p>or click to browse ‚Ä¢ PNG, JPG, WebP supported</p>
                        <div class="upload-divider">
                            <span>or import from URL</span>
                        </div>
                        <div class="url-tabs">
                            <button class="url-tab active" data-type="image">üñºÔ∏è Image URL</button>
                            <button class="url-tab" data-type="product">üõí Product Page</button>
                        </div>
                        <div class="url-input-wrap">
                            <input type="url" id="urlInput" placeholder="Paste image URL..." class="url-input">
                            <button class="btn btn-secondary" id="fetchUrlBtn">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                    stroke-width="2">
                                    <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4M7 10l5 5 5-5M12 15V3" />
                                </svg>
                                Import
                            </button>
                        </div>
                        <p class="url-hint" id="urlHint">Direct link to an image file</p>
                        <input type="file" id="fileInput" multiple accept="image/*" hidden>
                    </div>
                </div>

                <!-- Product Image Picker Modal -->
                <div class="modal-overlay" id="productPickerModal">
                    <div class="modal modal-lg glass-panel">
                        <div class="modal-header">
                            <h2>Select Product Images</h2>
                            <button class="btn-icon modal-close" id="closeProductPicker">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                    stroke-width="2">
                                    <path d="M18 6L6 18M6 6l12 12" />
                                </svg>
                            </button>
                        </div>
                        <div class="modal-content">
                            <p class="picker-status" id="pickerStatus">Loading images...</p>
                            <div class="product-images-grid" id="productImagesGrid"></div>
                        </div>
                        <div class="modal-footer">
                            <span class="selected-count" id="selectedCount">0 selected</span>
                            <button class="btn btn-primary" id="importSelectedBtn" disabled>Import Selected</button>
                        </div>
                    </div>
                </div>

                <!-- Preview Grid -->
                <div class="preview-section" id="previewSection">
                    <div class="preview-header">
                        <h2>Uploaded Samples <span class="count-badge" id="assetCount">0</span></h2>
                        <button class="btn btn-ghost" id="clearAllBtn">Clear All</button>
                    </div>
                    <div class="preview-grid" id="previewGrid"></div>
                </div>

                <!-- Style Analysis -->
                <div class="analysis-panel" id="analysisPanel">
                    <div class="analysis-header">
                        <h2>Style Analysis</h2>
                        <div class="analysis-status">
                            <span class="status-dot analyzing"></span>
                            <span id="analysisStatus">Analyzing...</span>
                        </div>
                    </div>
                    <div class="analysis-content">
                        <div class="analysis-card">
                            <h3>Color Palette</h3>
                            <div class="color-palette" id="colorPalette"></div>
                        </div>
                        <div class="analysis-card">
                            <h3>Style Profile</h3>
                            <div class="style-tags" id="styleTags"></div>
                        </div>
                        <div class="analysis-card">
                            <h3>Training Readiness</h3>
                            <div class="readiness-meter">
                                <div class="meter-bar">
                                    <div class="meter-fill" id="readinessFill"></div>
                                </div>
                                <span class="meter-label" id="readinessLabel">0/5 minimum images</span>
                            </div>
                        </div>
                    </div>
                    <button class="btn btn-primary btn-large" id="startTrainingBtn" disabled>
                        <span>Start Training</span>
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <path d="M5 12h14M12 5l7 7-7 7" />
                        </svg>
                    </button>
                </div>
            </section>

            <!-- Train Tab -->
            <section class="tab-content" id="trainTab">
                <div class="section-header">
                    <h1>Model Training Studio</h1>
                    <p>Configure and monitor your custom LoRA model training</p>
                </div>

                <div class="training-layout">
                    <!-- Training Config -->
                    <div class="training-config glass-panel">
                        <h2>Training Configuration</h2>
                        <div class="config-form">
                            <div class="form-group">
                                <label>Model Name</label>
                                <input type="text" id="modelName" placeholder="my-style-v1" class="form-input">
                                <p class="param-help">A unique name to identify this trained style</p>
                            </div>
                            <div class="form-group">
                                <label>Base Model</label>
                                <select id="baseModel" class="form-select">
                                    <option value="flux-dev">Flux Dev (Best Quality)</option>
                                    <option value="flux-schnell">Flux Schnell (Faster)</option>
                                </select>
                                <p class="param-help">The AI model that learns your style</p>
                            </div>
                            <div class="form-group">
                                <label>Training Duration</label>
                                <div class="slider-group">
                                    <input type="range" id="trainingSteps" min="300" max="1500" value="500"
                                        class="form-slider">
                                    <span class="slider-value" id="stepsValue">500</span>
                                </div>
                                <p class="param-help">‚ö° Less = faster but less accurate ‚Ä¢ üéØ More = slower but learns
                                    better</p>
                            </div>
                            <div class="form-group">
                                <label>Style Memory</label>
                                <div class="slider-group">
                                    <input type="range" id="loraRank" min="8" max="32" value="16" class="form-slider">
                                    <span class="slider-value" id="rankValue">16</span>
                                </div>
                                <p class="param-help">How much detail to remember ‚Ä¢ 16 works for most styles, increase
                                    for complex patterns</p>
                            </div>
                            <div class="form-group">
                                <label>Learning Speed</label>
                                <select id="learningRate" class="form-select">
                                    <option value="1e-4">Normal (Recommended)</option>
                                    <option value="5e-5">Careful (Better for subtle styles)</option>
                                    <option value="2e-4">Fast (May overfit)</option>
                                </select>
                                <p class="param-help">How aggressively the AI learns ‚Ä¢ Start with Normal</p>
                            </div>
                        </div>
                        <button class="btn btn-primary" id="launchTrainingBtn" disabled>
                            <span>Launch Training</span>
                        </button>
                    </div>

                    <!-- Training Progress -->
                    <div class="training-progress glass-panel">
                        <h2>Training Progress</h2>
                        <div class="progress-display" id="progressDisplay">
                            <div class="progress-idle">
                                <div class="idle-icon">üß†</div>
                                <p>No active training job</p>
                                <span>Configure and launch training to begin</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Model Registry -->
                <div class="model-registry glass-panel">
                    <h2>Trained Models</h2>
                    <div class="model-list" id="modelList">
                        <div class="empty-state">
                            <p>No trained models yet</p>
                            <span>Your trained models will appear here</span>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Generate Tab -->
            <section class="tab-content" id="generateTab">
                <div class="section-header">
                    <h1>Create Offshoots</h1>
                    <p>Generate styled variations from a reference image</p>
                </div>

                <div class="generate-layout">
                    <!-- Input Panel -->
                    <div class="generate-input glass-panel">
                        <h2>Reference Image</h2>
                        <div class="reference-upload" id="referenceUpload">
                            <div class="reference-placeholder">
                                <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                    stroke-width="1.5">
                                    <rect x="3" y="3" width="18" height="18" rx="2" />
                                    <circle cx="8.5" cy="8.5" r="1.5" />
                                    <path d="M21 15l-5-5L5 21" />
                                </svg>
                                <p>Drop reference image here</p>
                            </div>
                            <img id="referencePreview" class="reference-preview" hidden>
                            <input type="file" id="referenceInput" accept="image/*" hidden>
                        </div>

                        <div class="generate-options">
                            <div class="form-group">
                                <label>Select Model</label>
                                <select id="generateModel" class="form-select">
                                    <option value="">-- Select trained model --</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Variation Strength</label>
                                <div class="slider-group">
                                    <input type="range" id="variationStrength" min="0" max="100" value="50"
                                        class="form-slider">
                                    <span class="slider-value" id="strengthValue">50%</span>
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Number of Offshoots</label>
                                <div class="variation-count">
                                    <button class="count-btn" data-delta="-1">‚àí</button>
                                    <span id="variationCount">4</span>
                                    <button class="count-btn" data-delta="1">+</button>
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Style Guidance (Optional)</label>
                                <textarea id="stylePrompt" class="form-textarea"
                                    placeholder="e.g., 'more vibrant colors' or 'minimalist version'"></textarea>
                            </div>
                        </div>

                        <button class="btn btn-primary btn-large" id="generateBtn" disabled>
                            <span>Generate Offshoots</span>
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2" />
                            </svg>
                        </button>
                    </div>

                    <!-- Output Panel -->
                    <div class="generate-output glass-panel">
                        <div class="output-header">
                            <h2>Generated Offshoots</h2>
                            <div class="output-actions" id="outputActions" hidden>
                                <button class="btn btn-ghost btn-sm" id="downloadAllBtn">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                        stroke-width="2">
                                        <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4M7 10l5 5 5-5M12 15V3" />
                                    </svg>
                                    Download All
                                </button>
                            </div>
                        </div>
                        <div class="output-grid" id="outputGrid">
                            <div class="output-placeholder">
                                <div class="placeholder-icon">üå±</div>
                                <p>Your offshoots will appear here</p>
                                <span>Upload a reference image and select a model to begin</span>
                            </div>
                        </div>

                        <!-- Precision Validators -->
                        <div class="precision-panel" id="precisionPanel" hidden>
                            <h3>Quality Report</h3>
                            <div class="precision-checks">
                                <div class="precision-item" id="colorCheck">
                                    <span class="check-icon">üé®</span>
                                    <span class="check-label">Color Accuracy</span>
                                    <span class="check-value">--</span>
                                </div>
                                <div class="precision-item" id="logoCheck">
                                    <span class="check-icon">üè∑Ô∏è</span>
                                    <span class="check-label">Style Match</span>
                                    <span class="check-value">--</span>
                                </div>
                                <div class="precision-item" id="styleCheck">
                                    <span class="check-icon">üéØ</span>
                                    <span class="check-label">Consistency</span>
                                    <span class="check-value">--</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <!-- Settings Modal -->
        <div class="modal-overlay" id="settingsModal">
            <div class="modal modal-lg glass-panel">
                <div class="modal-header">
                    <h2>Settings</h2>
                    <button class="btn-icon modal-close" id="closeSettings">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <path d="M18 6L6 18M6 6l12 12" />
                        </svg>
                    </button>
                </div>
                <div class="modal-content">
                    <!-- Model Providers Section -->
                    <div class="settings-section">
                        <h3 class="settings-section-title">üîå Model Providers</h3>
                        <p class="settings-section-desc">Connect your API keys to enable generation and training</p>

                        <div class="provider-cards">
                            <!-- Gemini Card -->
                            <div class="provider-card" id="geminiCard">
                                <div class="provider-header">
                                    <div class="provider-icon gemini-icon">
                                        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                            <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5" />
                                        </svg>
                                    </div>
                                    <div class="provider-info">
                                        <span class="provider-name">Google Gemini</span>
                                        <span class="provider-use">Image Generation</span>
                                    </div>
                                    <div class="provider-status" id="geminiStatus">
                                        <span class="status-indicator"></span>
                                    </div>
                                </div>
                                <div class="provider-body">
                                    <input type="password" id="geminiKeyInput" placeholder="AIza..." class="form-input">
                                    <a href="https://aistudio.google.com/apikey" target="_blank"
                                        class="provider-link">Get API Key ‚Üí</a>
                                </div>
                            </div>

                            <!-- Replicate Card -->
                            <div class="provider-card" id="replicateCard">
                                <div class="provider-header">
                                    <div class="provider-icon replicate-icon">
                                        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                            <rect x="3" y="3" width="7" height="7" rx="1" />
                                            <rect x="14" y="3" width="7" height="7" rx="1" />
                                            <rect x="3" y="14" width="7" height="7" rx="1" />
                                            <rect x="14" y="14" width="7" height="7" rx="1" />
                                        </svg>
                                    </div>
                                    <div class="provider-info">
                                        <span class="provider-name">Replicate</span>
                                        <span class="provider-use">LoRA Training</span>
                                    </div>
                                    <div class="provider-status" id="replicateStatus">
                                        <span class="status-indicator"></span>
                                    </div>
                                </div>
                                <div class="provider-body">
                                    <input type="password" id="apiKeyInput" placeholder="r8_..." class="form-input">
                                    <a href="https://replicate.com/account/api-tokens" target="_blank"
                                        class="provider-link">Get API Key ‚Üí</a>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Preferences Section -->
                    <div class="settings-section">
                        <h3 class="settings-section-title">‚öôÔ∏è Preferences</h3>

                        <div class="form-group">
                            <label>Default Offshoots</label>
                            <select id="defaultVariations" class="form-select">
                                <option value="2">2 offshoots</option>
                                <option value="4" selected>4 offshoots</option>
                                <option value="6">6 offshoots</option>
                                <option value="8">8 offshoots</option>
                            </select>
                        </div>
                        <div class="checkbox-group">
                            <input type="checkbox" id="autoAnalyze" checked>
                            <label for="autoAnalyze">Auto-analyze uploaded samples</label>
                        </div>
                        <div class="checkbox-group">
                            <input type="checkbox" id="showPrecision" checked>
                            <label for="showPrecision">Show quality reports</label>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-primary" id="saveSettings">Save Settings</button>
                </div>
            </div>
        </div>

        <!-- Toast Container -->
        <div class="toast-container" id="toastContainer"></div>
    </div>

    <script type="module" src="app.js"></script>
</body>

</html>